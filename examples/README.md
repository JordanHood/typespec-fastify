# Examples

This directory contains example usage of the TypeSpec Fastify emitter.

## server.ts

A complete example showing how to:

- Create a Fastify instance with custom configuration
- Implement operation interfaces generated by the emitter
- Register generated routes with your Fastify instance
- Start the server

To use this example:

1. First, generate the TypeSpec output from the test fixtures:

   ```bash
   cd ../test/fixtures
   npx tsp compile petstore.tsp --output-dir ./tsp-output
   ```

2. Install fastify in the examples directory:

   ```bash
   npm install fastify
   ```

3. Run the example server:

   ```bash
   node server.ts
   ```

4. Test the API:
   ```bash
   curl http://localhost:3000/pets
   curl http://localhost:3000/pets/1
   ```

## Pattern

The emitter generates:

- **Operation interfaces** (`operations/*.ts`) - TypeScript interfaces you implement
- **Route handlers** (`routes/*.ts`) - Fastify route registration functions
- **Router** (`router.ts`) - Main `registerRoutes()` function
- **Models** (`models/*.ts`) - TypeScript type definitions
- **Response types** (`models/response-types.ts`) - `NoContentResponse` and `ResponseWithBody<T>`

You provide:

- **Fastify instance** - Configure it however you want
- **Operation implementations** - Your business logic that returns response objects
- **Server lifecycle** - When to start/stop

### Response Objects

Operations return response objects that control the HTTP response:

```typescript
// For operations returning data
return {
  statusCode: 200,
  body: data
};

// For operations with no content (like DELETE)
return {
  statusCode: 204
};
```

This gives you full control over your server and status codes while the emitter handles the HTTP routing boilerplate.
